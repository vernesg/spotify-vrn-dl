<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spotify Downloader</title>
  <style>
    /* (Use your preferred design ‚Äì previous styles can apply here) */
    body { background:#122; color:#eee; font-family:sans-serif; padding:40px; }
    input, button { padding:10px; font-size:16px; margin:5px 0; width:100%; max-width:500px; }
    .result { margin-top:20px; }
  </style>
</head>
<body>
  <h1>Spotify MP3 Downloader</h1>
  <input id="spotifyUrl" type="text" placeholder="Paste Spotify track URL here‚Ä¶" />
  <button onclick="download()">Download</button>
  <div class="result" id="result"></div>

  <script>
    async function download() {
      const input = document.getElementById("spotifyUrl");
      const resultDiv = document.getElementById("result");
      const url = input.value.trim();

      if (!url) {
        resultDiv.textContent = "‚ö†Ô∏è Please enter a Spotify URL.";
        return;
      }

      const apiUrl = `https://rapido.zetsu.xyz/api/sp-dl?url=${encodeURIComponent(url)}`;
      resultDiv.textContent = "üîÑ Contacting API‚Ä¶";

      try {
        const res = await fetch(apiUrl);

        // Check HTTP status
        if (!res.ok) {
          resultDiv.textContent = `‚ùå HTTP Error: ${res.status} ${res.statusText}`;
          return;
        }

        const data = await res.json();

        // Check top-level structure
        if (data.status !== true) {
          const errMsg = data.error || data.message || JSON.stringify(data);
          resultDiv.textContent = `‚ùå API returned status=false: ${errMsg}`;
          return;
        }

        const song = data.result;
        if (!song || !song.download_url) {
          resultDiv.textContent = "‚ùå No download URL found in response.";
          console.error("Response data:", data);
          return;
        }

        // Display results
        resultDiv.innerHTML = `
          ‚úÖ <strong>${song.title || 'Untitled'}</strong><br>
          Artist: ${song.artists || 'Unknown'}<br>
          <a href="${song.download_url}" download target="_blank">üéµ Click to Download</a>
        `;
      } catch (err) {
        console.error(err);
        const msg = err.name === 'TypeError' && err.message.includes('CORS')
          ? 'Possible CORS issue‚Äîrequest blocked by server.'
          : err.message;
        resultDiv.textContent = `üö´ Fetch Error: ${msg}`;
      }
    }
  </script>
</body>
</html>
